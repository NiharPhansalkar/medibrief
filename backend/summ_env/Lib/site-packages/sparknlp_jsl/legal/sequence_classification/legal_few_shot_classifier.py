from sparknlp_jsl.annotator import FewShotClassifierApproach, FewShotClassifierModel

class LegalFewShotClassifierApproach(FewShotClassifierApproach):
    """
    LegalFewShotClassifier is an implementation of SetFIT (Tunstall et al, 2022). The input to the model is sentence
    embeddings and the output is category annotations with labels and corresponding confidence scores varying
    between 0 and 1.

    ====================== ======================
    Input Annotation types Output Annotation type
    ====================== ======================
    ``SENTENCE_EMBEDDINGS``    ``CATEGORY``
    ====================== ======================
    """

    name = "LegalFewShotClassifierApproach"

    def __init__(self, classname="com.johnsnowlabs.legal.sequence_classification.LegalFewShotClassifierApproach"):
        super(LegalFewShotClassifierApproach, self).__init__(classname=classname)

class LegalFewShotClassifierModel(FewShotClassifierModel):
    """
    LegalFewShotClassifier is an implementation of SetFIT (Tunstall et al, 2022). The input to the model is sentence
    embeddings and the output is category annotations with labels and corresponding confidence scores varying
    between 0 and 1.

    ====================== ======================
    Input Annotation types Output Annotation type
    ====================== ======================
    ``SENTENCE_EMBEDDINGS``    ``CATEGORY``
    ====================== ======================
    """

    name = "LegalFewShotClassifierModel"

    def __init__(self, classname="com.johnsnowlabs.legal.sequence_classification.LegalFewShotClassifierModel",
                 java_model=None):
        super(LegalFewShotClassifierModel, self).__init__(
            classname=classname,
            java_model=java_model
        )

    @staticmethod
    def pretrained(name, lang="en", remote_loc="legal/models"):
        """Downloads and loads a pretrained model.

        Parameters
        ----------
        name : str, optional
            Name of the pretrained model
        lang : str, optional
            Language of the pretrained model, by default "en"
        remote_loc : str, optional
            Optional remote address of the resource, by default "legal/models". Will use
            Spark NLPs repositories otherwise.

        Returns
        -------
        LegalFewShotClassifierModel
            The restored model
        """
        from sparknlp_jsl.pretrained import InternalResourceDownloader
        return InternalResourceDownloader.downloadModel(LegalFewShotClassifierModel, name, lang, remote_loc,
                                                        j_dwn='InternalsPythonResourceDownloader')