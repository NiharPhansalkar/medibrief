from sparknlp_jsl.annotator import FewShotClassifierApproach, FewShotClassifierModel

class FinanceFewShotClassifierApproach(FewShotClassifierApproach):
    """
    FinanceFewShotClassifier is an implementation of SetFIT (Tunstall et al, 2022). The input to the model is sentence
    embeddings and the output is category annotations with labels and corresponding confidence scores varying
    between 0 and 1.

    ====================== ======================
    Input Annotation types Output Annotation type
    ====================== ======================
    ``SENTENCE_EMBEDDINGS``    ``CATEGORY``
    ====================== ======================
    """

    name = "FinanceFewShotClassifierApproach"

    def __init__(self, classname="com.johnsnowlabs.finance.sequence_classification.FinanceFewShotClassifierApproach"):
        super(FinanceFewShotClassifierApproach, self).__init__(classname=classname)

class FinanceFewShotClassifierModel(FewShotClassifierModel):
    """
    FinanceFewShotClassifier is an implementation of SetFIT (Tunstall et al, 2022). The input to the model is sentence
    embeddings and the output is category annotations with labels and corresponding confidence scores varying
    between 0 and 1.

    ====================== ======================
    Input Annotation types Output Annotation type
    ====================== ======================
    ``SENTENCE_EMBEDDINGS``    ``CATEGORY``
    ====================== ======================
    """

    name = "FinanceFewShotClassifierModel"

    def __init__(self, classname="com.johnsnowlabs.finance.sequence_classification.FinanceFewShotClassifierModel",
                 java_model=None):
        super(FinanceFewShotClassifierModel, self).__init__(
            classname=classname,
            java_model=java_model
        )

    @staticmethod
    def pretrained(name, lang="en", remote_loc="finance/models"):
        """Downloads and loads a pretrained model.

        Parameters
        ----------
        name : str, optional
            Name of the pretrained model
        lang : str, optional
            Language of the pretrained model, by default "en"
        remote_loc : str, optional
            Optional remote address of the resource, by default "finance/models". Will use
            Spark NLPs repositories otherwise.

        Returns
        -------
        FinanceFewShotClassifierModel
            The restored model
        """
        from sparknlp_jsl.pretrained import InternalResourceDownloader
        return InternalResourceDownloader.downloadModel(FinanceFewShotClassifierModel, name, lang, remote_loc,
                                                        j_dwn='InternalsPythonResourceDownloader')