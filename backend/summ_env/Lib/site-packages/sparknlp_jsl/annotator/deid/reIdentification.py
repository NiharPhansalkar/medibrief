from sparknlp_jsl.common import *


class ReIdentification(AnnotatorModelInternal):
    """Reidentifies obfuscated entities.

    Requires the outputs from the :py:class:`DeIdentification`_ annotator as input:
    - deidentified document
    - deidentification mappings set with `DeIdentification.setMappingsColumn`.

    To see how the entities are deidentified, please refer to the example of that class.

    Examples:
    `result` contains the deidentified document and the mappings in a spark data frame.
    >>>     reideintification = (
    ...         ReIdentification()
    ...         .setInputCols("dei", "protectedEntities")
    ...         .setOutputCol("reid")
    ...     ).transform(result)

    Deidentified results:

    >>> result.select("dei.result").show(truncate = false)
    +--------------------------------------------------------------------------------------------------+
    |result                                                                                            |
    +--------------------------------------------------------------------------------------------------+
    |[# 01010101 Date : 01/18/93 PCP : Dr. Gregory House , <AGE> years-old , Record date : 2079-11-14.]|
    +--------------------------------------------------------------------------------------------------+

    Reidentification results:
    >>> reideintification.selectExpr("explode(reid.result)").show(false)
    +-----------------------------------------------------------------------------------+
    |col                                                                                |
    +-----------------------------------------------------------------------------------+
    |# 7194334 Date : 01/13/93 PCP : Oliveira , 25 years-old , Record date : 2079-11-09.|
    +-----------------------------------------------------------------------------------+
    """
    inputAnnotatorTypes = [AnnotatorType.DOCUMENT, AnnotatorType.CHUNK]
    outputAnnotatorType = AnnotatorType.DOCUMENT
    name = "ReDeideintification"

    def __init__(self, classname="com.johnsnowlabs.nlp.annotators.deid.ReIdentification", java_model=None):
        super(ReIdentification, self).__init__(
            classname=classname,
            java_model=java_model
        )
